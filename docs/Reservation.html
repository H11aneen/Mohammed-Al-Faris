<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>صفحة الحجز</title>
  <meta name="description" content="محمد الفارس - مصور فوتوغرافي متخصص في  تصوير الزواجات والمناسبات ">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.4/moment.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/moment-hijri@2.1.2/moment-hijri.min.js"></script>

  <!-- Bootstrap CSS -->

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-5.3.3-dist/css/bootstrap.css">

<!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"> </script>



  <!-- تنسيقات -->





  
</head>
<body>
    <div id="back">
        <!--بداية الناف بار-->        
              <nav id="navbar">
                  <div class="navcont">
                  <div class="lglink">
                  <!-- الشعار على اليمين -->
                  <img src="logomo.png" class="logo" alt="الشعار">
              
                  <!-- القائمة بجانب الشعار -->
                  <ul class="nav-links">
                    <li><a href="index.html">الصفحة الرئيسية</a></li>
                    <li><a href="Albums.html">المعرض</a></li>
                    <li><a href="#footer1">للتواصل</a></li>
                  </ul>
              </div>
                  <!-- الزر على اليسار -->
                  <div class="bu1-1">
                    <button class="bureserv2" ><a style="text-decoration: none; color: #D4AF37 ;" href="Reservation.html">احجز الآن</a></button>
                  </div>
                  </div>
              </nav>      
        <!--نهاية الناف بار-->

        <div class="title-m">
            <h1>نموذج الحجز</h1>
        
       </div>

       <div class="form-container">
        
        <!-- القسم الأيمن: التقويم -->
        <div class="calendar">
          <div style="text-align: center; margin-bottom: 10px;">
              <button id="miladiBtn" class="toggle active">ميلادي</button>
              <button id="hijriBtn" class="toggle">هجري</button>
            </div>
          <div class="header">
              <button id="nextBtn"><i class="fa-solid fa-chevron-right"></i></button>
              <div class="monthYear" id="monthYear"></div>
              <button id="prevBtn"><i class="fa-solid fa-chevron-left"></i></button>
             
          </div>
  
          <div class="days">
             <div class="day">الاحد</div>
             <div class="day">الاثنين</div>
             <div class="day">الثلاثاء</div>
             <div class="day">الاربعاء</div>
             <div class="day">الخميس</div>
             <div class="day">الجمعة</div>
             <div class="day">السبت</div>
          </div>
  
          <div class="dates" id="dates"></div>
      </div>
     
      
  
  


        <!-- القسم الأيسر: الحقول -->
        <div class="form-fields" style="flex: 1;">
          <div class="mb-3">
            <label for="name">الاسم:</label>
            <input type="text" id="name" class="form-contro" placeholder="اكتب اسمك">
            <div id="nameError" class="error-message">يرجى إدخال الاسم</div>
          </div>
      
          <div class="mb-3">
            <label for="eventType">نوع المناسبة:</label>
            <input type="text" id="eventType" class="form-contro" placeholder="مثلاً: تصوير زواج">
            <div id="eventTypeError" class="error-message">يرجى إدخال نوع المناسبة</div>
          </div>

          

          <div class="mb-3">
            <label for="date">اختر التاريخ:</label>
            <input type="text" id="selectedDateInput" class="form-contro mb-3">
            <div id="dateError" class="error-message">يرجى اختيار التاريخ</div>
          </div>
      
          <button type="button" class="btn-whatsapp" id="whatsappLink">إتمام الحجز عبر الواتساب</button>
        </div>

       
      
        
    </div>



     <!-----------------------footer------------------------------>
        
     <footer class="footer" id="footer1">
            
      <div class="footer-logo">
          <img class="img-footer"  src="logomo.png">
      </div> 
          <h4>للتواصل</h4>
      <div class="ii">
          <a href="https://www.tiktok.com/@x_idzz?_t=ZS-8taDG3Nvnxo&_r=1" target="_blank"><i class="fa-brands fa-tiktok"></i></a>
          <a href="https://www.snapchat.com/add/x_idzz" target="_blank"><i class="fa-brands fa-snapchat"></i></a>
          <a href="#"><i class="fa-brands fa-whatsapp"></i></a>
          <a href="https://m.youtube.com/channel/UCS-agE6_uZUu_nkFPK7ocOQ" target="_blank"><i class="fa-brands fa-youtube"></i></a>
      </div>
  
  </footer>
  <!-- Flatpickr Scripts -->
  <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
  <script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/ar.js"></script>
<script>
  <!-- Script -->
  // -------------------------
  // المتغيرات الأساسية
  // -------------------------
  let currentDate = new Date();                     // التاريخ الحالي
  let useHijri = false;                             // false = ميلادي، true = هجري
  const monthYearElement = document.getElementById('monthYear'); // عنصر عرض الشهر والسنة
  const datesElement = document.getElementById('dates');         // عنصر يحتوي أيام الشهر
  const selectedDateInput = document.getElementById('selectedDateInput'); // حقل التاريخ المختار
  const hijriBtn = document.getElementById('hijriBtn');          // زر هجري
  const miladiBtn = document.getElementById('miladiBtn');        // زر ميلادي
  const prevBtn = document.getElementById('prevBtn');            // زر الشهر السابق
  const nextBtn = document.getElementById('nextBtn');            // زر الشهر التالي
  
  let disabledDates = []; // مصفوفة لتخزين التواريخ المحجوزة
  
  // -------------------------
  // تحديث التقويم
  // -------------------------
  function updateCalendar() {
    datesElement.innerHTML = ''; // تفريغ التقويم القديم
  
    let firstDay, totalDays;
  
    if (useHijri) {
      // التقويم الهجري
      const hijriMoment = moment(currentDate).locale('ar-SA').startOf('iMonth'); // بداية الشهر الهجري
      firstDay = hijriMoment.day();             // يوم بداية الشهر (0-6)
      totalDays = hijriMoment.iDaysInMonth();  // عدد أيام الشهر الهجري
      monthYearElement.textContent = hijriMoment.format('iMMMM iYYYY هـ'); // عرض الشهر والسنة الهجرية
    } else {
      // التقويم الميلادي
      const year = currentDate.getFullYear();
      const month = currentDate.getMonth();
      const firstDate = new Date(year, month, 1);
      firstDay = firstDate.getDay();                      // يوم بداية الشهر
      totalDays = new Date(year, month + 1, 0).getDate(); // عدد أيام الشهر الميلادي
      monthYearElement.textContent = currentDate.toLocaleDateString('ar-EG', { year: 'numeric', month:'long' });
    }
  
    // -------------------------
    // إضافة خانات فارغة قبل أول يوم
    // -------------------------
    for (let i = 0; i < firstDay; i++) {
      const emptyCell = document.createElement('div');
      emptyCell.className = 'date empty';
      datesElement.appendChild(emptyCell);
    }
  
    // -------------------------
    // إنشاء أيام الشهر
    // -------------------------
    for (let i = 1; i <= totalDays; i++) {
      const dayDiv = document.createElement('div');
      dayDiv.classList.add('date');
      dayDiv.textContent = i;
      dayDiv.dataset.day = i; // نخزن الرقم لتحديث لاحقًا
      datesElement.appendChild(dayDiv);
    }
  
    // -------------------------
    // تحديث التواريخ المحجوزة
    // -------------------------
    markDisabledDates();
  }
  
  // -------------------------
  // تحديث الأيام المحجوزة بعد وصول البيانات
  // -------------------------
  function markDisabledDates() {
    const today = moment().startOf('day');
  
    document.querySelectorAll('.date').forEach(dayDiv => {
      const day = parseInt(dayDiv.dataset.day);
      if (!day) return; // تجاهل الخانات الفارغة
  
      let dateMoment;
  
      if (useHijri) {
        const baseHijri = moment(currentDate).startOf('iMonth');
        dateMoment = moment(`${baseHijri.iYear()}-${baseHijri.iMonth() + 1}-${day}`, 'iYYYY-iM-iD');
      } else {
        dateMoment = moment(new Date(currentDate.getFullYear(), currentDate.getMonth(), day));
      }
  
      const dateString = dateMoment.format('YYYY-MM-DD');
  
      // تعطيل الأيام المحجوزة
      if (disabledDates.includes(dateString)) {
        dayDiv.classList.add('disabled');
        dayDiv.textContent = day + " (محجوز)";
        dayDiv.style.backgroundColor = '#eee';
        dayDiv.style.color = '#aaa';
        dayDiv.style.cursor = 'not-allowed';
      } 
      // تعطيل الأيام السابقة لليوم الحالي
      else if (dateMoment.isBefore(today, useHijri ? 'iDate' : 'day')) {
        dayDiv.classList.add('disabled');
        dayDiv.style.color = '#aaa';
        dayDiv.style.cursor = 'not-allowed';
      }
    });
  }
  
  // -------------------------
  // جلب التواريخ المحجوزة من Google Script
  // -------------------------
  async function fetchDisabledDates() {
    try {
      const response = await fetch('https://script.google.com/macros/s/AKfycbwoGKyPVthp5el4z8ZhV2IMA4c6vSxFi_cY61E_hpAUwYD04n2b-ubnSntj0oXebcjVHw/exec');
      const data = await response.json();
      // تحويل التواريخ لصيغة YYYY-MM-DD
      disabledDates = data.map(d => new Date(d).toLocaleDateString('sv-SE'));
      // بعد وصول البيانات، نحدّث التقويم
      markDisabledDates();
    } catch (error) {
      console.error("Failed to fetch disabled dates:", error);
    }
  }
  
  // -------------------------
  // تفعيل اختيار التاريخ عند النقر
  // -------------------------
  document.addEventListener('click', function (e) {
    if (e.target.classList.contains('date') &&
        !e.target.classList.contains('empty') &&
        !e.target.classList.contains('disabled')) {
      document.querySelectorAll('.date.selected').forEach(el => el.classList.remove('selected'));
      e.target.classList.add('selected');
  
      const selectedDay = parseInt(e.target.textContent.trim());
      let selectedMoment;
  
      if (useHijri) {
        const baseHijri = moment(currentDate).startOf('iMonth');
        selectedMoment = moment(`${baseHijri.iYear()}-${baseHijri.iMonth() + 1}-${selectedDay}`, 'iYYYY-iM-iD');
        selectedDateInput.value = selectedMoment.format('iYYYY/iM/iD');
      } else {
        selectedMoment = moment(new Date(currentDate.getFullYear(), currentDate.getMonth(), selectedDay));
        selectedDateInput.value = selectedMoment.format('YYYY-MM-DD');
      }
    }
  });
  
  // -------------------------
  // أزرار التنقل بين الأشهر
  // -------------------------
  prevBtn.addEventListener('click', () => {
    if (useHijri) currentDate = moment(currentDate).subtract(1, 'iMonth').toDate();
    else currentDate.setMonth(currentDate.getMonth() - 1);
    updateCalendar();
  });
  
  nextBtn.addEventListener('click', () => {
    if (useHijri) currentDate = moment(currentDate).add(1, 'iMonth').toDate();
    else currentDate.setMonth(currentDate.getMonth() + 1);
    updateCalendar();
  });
  
  // -------------------------
  // أزرار التبديل بين الهجري والميلادي
  // -------------------------
  hijriBtn.addEventListener('click', () => {
    useHijri = true;
    hijriBtn.classList.add('active');
    miladiBtn.classList.remove('active');
    selectedDateInput.value = '';
    updateCalendar();
  });
  
  miladiBtn.addEventListener('click', () => { 
    useHijri = false;
    miladiBtn.classList.add('active');
    hijriBtn.classList.remove('active');
    selectedDateInput.value = '';
    updateCalendar();
  });
  
  // -------------------------
  // تنفيذ التقويم فوراً عند تحميل الصفحة
  // -------------------------
  updateCalendar();      // عرض التقويم فورًا
  fetchDisabledDates();  // تحديث الأيام المحجوزة لاحقًا
  
// زر الإرسال للواتساب
document.getElementById("whatsappLink").addEventListener("click", function () {
  const nameInput = document.getElementById("name");
  const eventTypeInput = document.getElementById("eventType");
  const dateInput = document.getElementById("selectedDateInput");

  const name = nameInput.value.trim();
  const eventType = eventTypeInput.value.trim();
  const date = dateInput.value.trim();

  let hasError = false;

  // تفريغ الأخطاء السابقة
  document.querySelectorAll(".error-message").forEach(el => el.style.display = "none");
  document.querySelectorAll("input").forEach(el => el.classList.remove("input-error"));

  if (!name) {
    document.getElementById("nameError").style.display = "block";
    nameInput.classList.add("input-error");
    hasError = true;
  }

  if (!eventType) {
    document.getElementById("eventTypeError").style.display = "block";
    eventTypeInput.classList.add("input-error");
    hasError = true;
  }

  if (!date) {
    document.getElementById("dateError").style.display = "block";
    dateInput.classList.add("input-error");
    hasError = true;
  }

  if (hasError) return;

  const message = `مرحبًا، أرغب بحجز موعد تصوير:\nالاسم: ${name}\nنوع المناسبة: ${eventType}\nالتاريخ: ${date}`;
  const whatsappUrl = `https://wa.me/966503775085?text=${encodeURIComponent(message)}`;
  window.open(whatsappUrl, '_blank');
});



   </script>
 

    </div>
</body>
</html>
